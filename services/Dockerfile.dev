# ------------------------------------
# Django DRF Development environment (backend)
# ------------------------------------
FROM python:3.11-slim

# Install OS dependencies (such as SQLite libraries)
RUN apt-get update && \
    apt-get install -y --no-install-recommends \
    build-essential \
    libpq-dev \
    # The SQLite3 library (sometimes provided separately from the one built into Python)
    sqlite3 libsqlite3-dev \
    && rm -rf /var/lib/apt/lists/*

# Setting the work directory
WORKDIR /app

# Copying and installing dependency files
COPY requirements.dev.txt /app/
RUN pip install --no-cache-dir -r requirements.dev.txt

# The code is mounted via volumes, so it is not copied here (for hot reloading).

# Port exposure (published externally via docker-compose)
EXPOSE 8000

# Start the Django development server when the container starts.
# For hot reload, 'python manage.py runserver 0.0.0.0:8000' is usually used,
# but when using VSCode Dev Container or external tools, move the command to docker-compose
CMD ["tail", "-f", "/dev/null"] 
# Dummy command to keep the container running during development.
# The actual server start command is executed after mounting volumes in docker-compose.yml.